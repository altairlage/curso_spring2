<!DOCTYPE html>
<!-- saved from url=(0096)https://cursos.alura.com.br/course/springmvc-2-integracao-cache-seguranca-e-templates/task/12225 -->
<html lang="pt-BR" data-product="alura" class="gr__cursos_alura_com_br"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	
	<title>Spring MVC II: Aula 1 - Atividade 5 Melhorando a home  | Alura - Cursos online de tecnologia</title>
	
	
<script type="text/javascript" src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/b5f9030682"></script><script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/nr-1059.min.js.download"></script><script type="text/javascript" async="" src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/amplitude-3.0.2-min.gz.js.download"></script><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(2),u=e(3),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}finally{f.emit("fn-end",[c.now()],t)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now()])}},{}],2:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],3:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],4:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=m(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){v[e]=m(e).concat(n)}function m(e){return v[e]||[]}function w(e){return p[e]=p[e]||o(t)}function g(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var v={},y={},b={on:l,emit:t,get:w,listeners:m,context:n,buffer:g,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(2),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!x++){var e=h.info=NREUM.info,n=d.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+h.offset],null,"api");var t=d.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===d.readyState&&i()}function i(){f("mark",["domContent",a()+h.offset],null,"api")}function a(){return E.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-h.offset}var u=(new Date).getTime(),f=e("handle"),c=e(2),s=e("ee"),p=window,d=p.document,l="addEventListener",m="attachEvent",w=p.XMLHttpRequest,g=w&&w.prototype;NREUM.o={ST:setTimeout,SI:p.setImmediate,CT:clearTimeout,XHR:w,REQ:p.Request,EV:p.Event,PR:p.Promise,MO:p.MutationObserver};var v=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1059.min.js"},b=w&&g&&g[l]&&!/CriOS/.test(navigator.userAgent),h=n.exports={offset:u,now:a,origin:v,features:{},xhrWrappable:b};e(1),d[l]?(d[l]("DOMContentLoaded",i,!1),p[l]("load",r,!1)):(d[m]("onreadystatechange",o),p[m]("onload",r)),f("mark",["firstbyte",u],null,"api");var x=0,E=e(4)},{}]},{},["loader"]);</script><link rel="shortcut icon" href="https://cursos.alura.com.br/images/alura/favicon.ico">
	
	<link href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/css" rel="stylesheet">
	<link rel="preconnect" href="https://fonts.gstatic.com/">
	
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/video-js.fcfc2231.css">
    <link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/video-js-resolutions.b7de6fd3.css">
    <link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/prettify.1b9e73a7.css">

	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/base.78b97371.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/formattedText.781e69ae.css">
	
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/container.d7849dcf.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/classPage.21eeda42.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/menuSettings.da4e6ad5.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/alternativeList.0fb16f2e.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/taskFeedback.4bdd6c19.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/markdown.19173ffa.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/finishSection.0a96466a.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/phrase.6d880b7f.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/hqexplanation.3ed41021.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/openquestion.811813bb.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/textcontent.7298b79f.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/video.45bb70c3.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/singlechoice.05e6d21d.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/music.324695f6.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/multiplechoice.9df58fa7.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/videodialog.fc98d79c.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/fillintheblank.81cde842.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/speakingpractice.5068bb32.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/pronunciationpractice.7d2876f7.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/repetition.0dac6920.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/genericVideo.2942980e.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/taskContent.000f28c0.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/taskButtons.563efe7a.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/markdownEditor.26173654.css">
	<link rel="stylesheet" href="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/audioPlayer.be1ece2d.css">

	
	
	<style type="text/css">
		.task:before {
			background-color: #FFE000;
		}
	</style>
	
	
	
	</head>
<body data-gr-c-s-loaded="true">

<section class="task" data-task-type="hqexplanation" data-task-id="12225" data-author-id="75042" data-course-code="springmvc-2-integracao-cache-seguranca-e-templates" data-section-number="1" data-domain="cursos.alura.com.br" data-hasfeedbackanswer="false" data-url-prefix="/">
	<button title="Abrir/Fechar menu" aria-label="Abrir/Fechar menu" type="button" class="openMenu-button task-body-button "></button>
	
	<section class="task-body">
		<header class="task-body-header">
			<div class="container">
				<h1 class="task-body-header-title">
					<svg class="task-body-header-title-svg" aria-label="Atividade de Explicação">
						<use xlink:href="/images/gnarus/classPage/icon-menu-icons.svg#HQ_EXPLANATION"></use>
					</svg>
					<small>05</small>
					<span class="task-body-header-title-text"> Melhorando a home </span>
				</h1>
				<div class="task-body-header-actions">
					<a href="https://cursos.alura.com.br/course/springmvc-2-integracao-cache-seguranca-e-templates/task/12225/next" aria-hidden="true" class="task-actions-button task-actions-button-next task-submit">Próxima Atividade</a>
				</div>
			</div>
		</header>
		<main class="task-body-main" data-should-warn="false">
			





	
		




<section class="hqExplanation" id="task-content">
	<div class="container">
	




<div class="settings">
	<button type="button" class="settings-button" aria-label="Configurações"></button>
	<div class="settings-box">
		<span class="settings-box-title"></span>
		<ul class="settings-box-list">
			
				
				
				
					<li class="settings-box-item settings-box-item-player"><a class="settings-box-item-player--disabled" onclick="event.preventDefault();">Mudar o Player</a></li>
					
						<li class="settings-box-item settings-box-item-suggestion"><a href="https://cursos.alura.com.br/suggestions/new/springmvc-2-integracao-cache-seguranca-e-templates/12225/question">Sugerir Melhoria</a></li>
					
				
			
			
		</ul>
	</div>
</div>
		<div class="formattedText">
			<h2>Melhorando a home</h2>
<p>Bem-vindo ao segundo módulo do curso de <strong>Spring MVC</strong>. Neste curso continuaremos a desenvolver a aplicação da <strong>Casa do Código</strong> que iniciamos no primeiro módulo.</p>
<p>Se abrirmos a página inicial da nossa aplicação, veremos que ela não tem o nome do projeto e uma lista de livros em texto puro, sem nenhum estilo. Queremos estilizar esta página, até que ela fique mais próxima do estilo do site da Casa do Código <a href="http://www.casadocodigo.com.br/" rel="nofollow">Casa do Código</a>.</p>
<p>Veja como está nossa página inicial, atualmente:  </p>
<p> <img src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/spring-mvc-II-aula1-pagina-inicial.png" alt="pagina inicial do nosso projeto">
Queremos deixá-la assim:  </p>
<p> <img src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/spring-mvc-II-aula1-listagem-casa-do-codigo.png" alt="pagina inicial da casa do codigo"></p>
<p>O primeiro passo será copiar o HTML da página, que poderá ser baixado em: <a href="https://s3.amazonaws.com/caelum-online-public/springmvc-2-integracao-cache-seguranca-e-templates/home-casadocodigo-antiga.zip" rel="nofollow"></a><a href="https://s3.amazonaws.com/caelum-online-public/springmvc-2-integracao-cache-seguranca-e-templates/home-casadocodigo-antiga.zip" rel="nofollow">https://s3.amazonaws.com/caelum-online-public/springmvc-2-integracao-cache-seguranca-e-templates/home-casadocodigo-antiga.zip</a></p>
<p>Baixe o arquivo e descompacte, verifique se o arquivo <code>home.jsp</code> se encontra no <em>zip</em>. Depois, apague o arquivo <code>home.jsp</code> que está no seu projeto atualmente. Este arquivo se encontra em: <code>webapp/WEB-INF/views/</code>. Após apagar o arquivo, copie o novo arquivo que acabou de baixar para esta mesma pasta. Feito isso, podemos continuar.</p>
<p>Dentro do arquivo <code>home.jsp</code>, precisamos encontrar o trecho de código responsável por exibir cada um dos livros e fazer com que esse trecho exiba os livros que temos em nosso banco de dados. Para isto, procure o seguinte trecho de código:</p>
<pre class="prettyprint"><code><span class="tag">&lt;li&gt;</span><span class="pln">
    </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"URL para o livro"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"block clearfix"</span><span class="tag">&gt;</span><span class="pln">
        </span><span class="tag">&lt;h2</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"product-title"</span><span class="tag">&gt;</span><span class="pln">Java 8 Prático</span><span class="tag">&lt;/h2&gt;</span><span class="pln">
        </span><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">width</span><span class="pun">=</span><span class="atv">"143"</span><span class="pln">
            </span><span class="atn">height</span><span class="pun">=</span><span class="atv">"202"</span><span class="pln">
            </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"https://cdn.shopify.com/s/files/1/0155/7645/products/java8-featured_large.png?v=1411490181"</span><span class="pln">
            </span><span class="atn">alt</span><span class="pun">=</span><span class="atv">"Java 8 Prático"</span><span class="pln">
            </span><span class="atn">title</span><span class="pun">=</span><span class="atv">"Java 8 Prático"</span><span class="tag">/&gt;</span><span class="pln">
        </span><span class="tag">&lt;small</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"buy-button"</span><span class="tag">&gt;</span><span class="pln">Compre</span><span class="tag">&lt;/small&gt;</span><span class="pln">
    </span><span class="tag">&lt;/a&gt;</span><span class="pln">
</span><span class="tag">&lt;/li&gt;</span></code></pre>
<p>Note que a exibição dos livros é feita dentro de uma simples lista, e cada item <code>&lt;li&gt;</code> corresponde a um livro. Para que exibamos os livros então, precisaremos fazer um laço que percorra toda a nossa coleção de produtos e mostre suas informações.</p>
<p>Para isto, faremos um <code>forEach</code> na variável <code>produtos</code>. Como está é uma variável temporária no atributo <code>var</code> do <code>forEach</code>, usaremos outra variável: <code>produto</code>. Lembre-se que este laço deve envolver o item de lista inteiro da seguinte forma:</p>
<pre class="prettyprint"><code><span class="tag">&lt;c:forEach</span><span class="pln"> </span><span class="atn">items</span><span class="pun">=</span><span class="atv">"${produtos}"</span><span class="pln"> </span><span class="atn">var</span><span class="pun">=</span><span class="atv">"produto"</span><span class="tag">&gt;</span><span class="pln">

</span><span class="tag">&lt;li&gt;</span><span class="pln">
  </span><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"URL para o livro"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"block clearfix"</span><span class="tag">&gt;</span><span class="pln">
          </span><span class="tag">&lt;h2</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"product-title"</span><span class="tag">&gt;</span><span class="pln">Java 8 Prático</span><span class="tag">&lt;/h2&gt;</span><span class="pln">
          </span><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">width</span><span class="pun">=</span><span class="atv">"143"</span><span class="pln">
              </span><span class="atn">height</span><span class="pun">=</span><span class="atv">"202"</span><span class="pln">
              </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"https://cdn.shopify.com/s/files/1/0155/7645/products/java8-featured_large.png?v=1411490181"</span><span class="pln">
              </span><span class="atn">alt</span><span class="pun">=</span><span class="atv">"Java 8 Prático"</span><span class="pln">
              </span><span class="atn">title</span><span class="pun">=</span><span class="atv">"Java 8 Prático"</span><span class="tag">/&gt;</span><span class="pln">
          </span><span class="tag">&lt;small</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"buy-button"</span><span class="tag">&gt;</span><span class="pln">Compre</span><span class="tag">&lt;/small&gt;</span><span class="pln">
  </span><span class="tag">&lt;/a&gt;</span><span class="pln">
</span><span class="tag">&lt;/li&gt;</span><span class="pln">

</span><span class="tag">&lt;/c:forEach&gt;</span></code></pre>
<p>Agora precisamos exibir o nome do livro e construir  a <em>URL</em> que quando clicada deverá levar o usuário à página de detalhes do livro. Neste mesmo bloco, montaremos a <em>URL</em> para a página de detalhes do livro onde há:  </p>
<pre class="prettyprint"><code><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"URL para o livro"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"block clearfix"</span><span class="tag">&gt;</span></code></pre>
<p>Faremos da seguinte forma:</p>
<pre class="prettyprint"><code><span class="tag">&lt;a</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">href="${s:mvcUrl('PC#detalhe').arg(0, produto.id).build()}"</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"block clearfix"</span><span class="tag">&gt;</span></code></pre>
<p>Estamos usando o <code>mvcUrl</code> do <em>Spring</em> para criarmos uma <em>URL</em> que será atendida pelo método <code>detalhe</code> da classe <code>ProdutosController</code> e passando para este método o <code>id</code> do livro como parâametro e no fim, pedimos para o <em>Spring</em> construir a <em>URL</em> através do método <code>build()</code>.</p>
<p>A próxima informação a ser exibida será o título do livro, localizada na seguinte linha do código:  </p>
<pre class="prettyprint"><code><span class="tag">&lt;h2</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"product-title"</span><span class="tag">&gt;</span><span class="pln">Java 8 Prático</span><span class="tag">&lt;/h2&gt;</span></code></pre>
<p>Este passo é bem simples, basta trocar o título que está no texto por um trecho de código <strong>Java</strong>:</p>
<pre class="prettyprint"><code><span class="tag">&lt;h2</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"product-title"</span><span class="tag">&gt;</span><span class="pln">${produto.titulo}</span><span class="tag">&lt;/h2&gt;</span></code></pre>
<p>O código responsável por exibir a listagem dos livros após todas as modificações ficará da seguinte forma:</p>
<pre class="prettyprint"><code><span class="tag">&lt;c:forEach</span><span class="pln"> </span><span class="atn">items</span><span class="pun">=</span><span class="atv">"${produtos}"</span><span class="pln"> </span><span class="atn">var</span><span class="pun">=</span><span class="atv">"produto"</span><span class="tag">&gt;</span><span class="pln">

    </span><span class="tag">&lt;li&gt;</span><span class="pln">
    &lt;a href="</span><span class="tag">&lt;s:mvcUrl</span><span class="pln">(</span><span class="atv">'PC#detalhe'</span><span class="pln">).</span><span class="atn">arg</span><span class="pln">(0, </span><span class="atn">produto</span><span class="pln">.</span><span class="atn">id</span><span class="pln">).</span><span class="atn">build</span><span class="pln">()</span><span class="atv">" class="</span><span class="atn">block</span><span class="pln"> </span><span class="atn">clearfix</span><span class="atv">"&gt;</span><span class="pln">
            </span><span class="tag">&lt;h2</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"product-title"</span><span class="tag">&gt;</span><span class="pln">${produto.titulo}</span><span class="tag">&lt;/h2&gt;</span><span class="pln">
            </span><span class="tag">&lt;img</span><span class="pln"> </span><span class="atn">width</span><span class="pun">=</span><span class="atv">"143"</span><span class="pln">
                </span><span class="atn">height</span><span class="pun">=</span><span class="atv">"202"</span><span class="pln">
                </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"https://cdn.shopify.com/s/files/1/0155/7645/products/java8-featured_large.png?v=1411490181"</span><span class="pln">
                </span><span class="atn">alt</span><span class="pun">=</span><span class="atv">"Java 8 Prático"</span><span class="pln">
                </span><span class="atn">title</span><span class="pun">=</span><span class="atv">"Java 8 Prático"</span><span class="tag">/&gt;</span><span class="pln">
            </span><span class="tag">&lt;small</span><span class="pln"> </span><span class="atn">class</span><span class="pun">=</span><span class="atv">"buy-button"</span><span class="tag">&gt;</span><span class="pln">Compre</span><span class="tag">&lt;/small&gt;</span><span class="pln">
    </span><span class="tag">&lt;/a&gt;</span><span class="pln">
    </span><span class="tag">&lt;/li&gt;</span><span class="pln">

</span><span class="tag">&lt;/c:forEach&gt;</span></code></pre>
<p>Nosso trabalho com a <em>view</em> termina aqui. Agora precisamos atualizar o <code>HomeController</code> para que ele passe para o <code>home.jsp</code>, a lista de livros que estamos querendo exibir. Veja como está o <code>HomeController</code> atualmente:</p>
<pre class="prettyprint"><code><span class="lit">@Controller</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">HomeController</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="lit">@RequestMapping</span><span class="pun">(</span><span class="str">"/"</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> index</span><span class="pun">(){</span><span class="pln">
        </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"Entrando na home da CDC"</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="str">"home"</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

</span><span class="pun">}</span></code></pre>
<p>Basicamente, sua função é imprimir uma mensagem no console e retornar a <em>view</em>. Agora, o que precisamos fazer é usar o <code>ProdutoDao</code> para buscar os produtos no banco de dados e mandar a coleção de itens para a <em>view</em> através do <code>ModelAndView</code>.</p>
<p>Crie o atributo <code>produtoDao</code> do tipo <code>ProdutoDao</code>, em seguida, marque-o com a anotação <code>@Autowired</code>. Após isto, dentro do método <code>index</code> use o método <code>listar</code> do <code>produtoDao</code> e atribua o resultado a uma lista que chamaremos de <code>produtos</code>. Crie um objeto <code>modelAndView</code> do tipo <code>ModelAndView</code> que se direcionará para a <em>view</em> <code>home.jsp</code> e use o método <code>addObject</code> para anexar a listagem dos produtos. Como último passo, retorne o objeto <code>modelAndView</code>. Desta forma teremos:</p>
<pre class="prettyprint"><code><span class="lit">@Controller</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">HomeController</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

    </span><span class="lit">@Autowired</span><span class="pln">
    </span><span class="typ">ProdutoDAO</span><span class="pln"> produtoDao</span><span class="pun">;</span><span class="pln">

    </span><span class="lit">@RequestMapping</span><span class="pun">(</span><span class="str">"/"</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">ModelAndView</span><span class="pln"> index</span><span class="pun">(){</span><span class="pln">
        </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Produto</span><span class="pun">&gt;</span><span class="pln"> produtos </span><span class="pun">=</span><span class="pln"> produtoDao</span><span class="pun">.</span><span class="pln">listar</span><span class="pun">();</span><span class="pln">
        </span><span class="typ">ModelAndView</span><span class="pln"> modelAndView </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ModelAndView</span><span class="pun">(</span><span class="str">"home"</span><span class="pun">);</span><span class="pln">
        modelAndView</span><span class="pun">.</span><span class="pln">addObject</span><span class="pun">(</span><span class="str">"produtos"</span><span class="pun">,</span><span class="pln"> produtos</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> modelAndView</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

</span><span class="pun">}</span></code></pre>
<p>Perceba que o retorno do método <code>index</code> mudou em sua assinatura, fizemos a alteração porque não estamos mais retornando o nome da <em>view</em>, mas sim, um outro objeto que além de saber qual <strong>view</strong> carregar, também leva dados importantes para serem exibidos.</p>
<p>Observe também que as imagens de miniatura dos livros serão as mesmas para todos, infelizmente não criamos uma lógica para permitir que cada produto tenha sua miniatura de foto. Fica o desafio para que você faça...</p>
<p>Com a atualização, já podemos verificar como ficou a página inicial da aplicação remodelada.</p>
<p><img src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/spring-mvc-II-aula1-nova-home.png" alt="pagina inicial remodelada"></p>
<h3>Habilitando o cache</h3>
<p>Em seguida, vamos pensar um pouco em performance. Você já pensou sobre a frequência em que os livros da Casa do Código são lançados? Os lançamentos não são feitos todos os dias, concorda? Em geral, passará um tempo antes de que a lista seja modificada (uma semana ou até mais).</p>
<p>Algo comum em aplicações deste tipo é o uso de <strong>Cache</strong> - um recurso que permite que guardemos informações no contexto da aplicação. Geralmente, os dados ficam armazenados no banco de dados - com acesso ao disco rígido. Com o uso de <code>cache</code>, quando as informações forem requisitadas, a aplicação já as terá e não precisará carregá-las novamente.</p>
<p>A subtituição por  um acesso em memória, onde o <strong>cache</strong> é guardado, agiliza o processo. E a listagem dos livros parece ser um bom lugar para o uso de <strong>cache</strong>. Como a lista não muda com muita frequência, iremos usar este recurso, então. Faremos isto facilmente no <strong>Spring</strong>. Precisamos apenas marcar o método que tem os resultados a serem "cacheados" com a anotação <code>@Cacheable</code>. Assim faremos no método <code>index</code>, da classe <code>HomeController</code>.</p>
<pre class="prettyprint"><code><span class="lit">@RequestMapping</span><span class="pun">(</span><span class="str">"/"</span><span class="pun">)</span><span class="pln">
</span><span class="lit">@Cacheable</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">ModelAndView</span><span class="pln"> index</span><span class="pun">(){</span><span class="pln">
  </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Produto</span><span class="pun">&gt;</span><span class="pln"> produtos </span><span class="pun">=</span><span class="pln"> produtoDao</span><span class="pun">.</span><span class="pln">listar</span><span class="pun">();</span><span class="pln">
  </span><span class="typ">ModelAndView</span><span class="pln"> modelAndView </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ModelAndView</span><span class="pun">(</span><span class="str">"home"</span><span class="pun">);</span><span class="pln">
  modelAndView</span><span class="pun">.</span><span class="pln">addObject</span><span class="pun">(</span><span class="str">"produtos"</span><span class="pun">,</span><span class="pln"> produtos</span><span class="pun">);</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> modelAndView</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>Agora precisamos testar se isso realmente vai funcionar. Reinicie o servidor e quando ele estiver apto novamente, limpe o console do <strong>Eclipse</strong> e abra a página inicial da aplicação no navegador. O código <code>SQL</code> da busca pelos livros no banco de dados deve ser impressa uma vez. E se atualizarmos a página? Com o cache habilitado, não deveria aparecer nada mais no console, porem vejá o que acontece.</p>
<p><img src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/spring-mvc-II-aula1-query-executada-duas-vezes.png" alt="query sendo executada pela segunda vez"></p>
<p>É estranho, mas o código <code>SQL</code> aparece duas vezes. Isto não deveria acontece. Porém, em momento algum configuramos o cache da aplicação. Simplesmente usar a anotação não resolverá o problema, precisaremos habilitar o cache do <strong>Spring</strong>.</p>
<p>Esta configuração é feita na classe <code>AppWebConfiguration</code> e terá dois passos. O primeiro deles é marcar a classe com a anotação <code>@EnableCaching</code>. O segundo é fornecer um gerenciador de cache para que o <strong>Spring</strong> o use. Criaremos um novo método nesta mesma classe chamado <code>cacheManager</code>, que retornará um objeto do tipo <code>CacheManager</code>. Usaremos um gerenciador de cache que o <strong>Spring</strong> já fornece chamado <code>ConcurrentMapCacheManager</code>. Lembre-se de marcar este método com a anotação <code>@Bean</code>. Assim teremos:</p>
<pre class="prettyprint"><code><span class="lit">@EnableWebMvc</span><span class="pln">
</span><span class="lit">@ComponentScan</span><span class="pun">(</span><span class="pln">basePackageClasses</span><span class="pun">={</span><span class="typ">HomeController</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ProdutoDAO</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">,</span><span class="pln"> </span><span class="typ">FileSaver</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CarrinhoCompras</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">})</span><span class="pln">
</span><span class="lit">@EnableCaching</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">AppWebConfiguration</span><span class="pln"> </span><span class="pun">{</span><span class="pln">

  </span><span class="pun">[...]</span><span class="pln">

  </span><span class="lit">@Bean</span><span class="pln">
    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">CacheManager</span><span class="pln"> cacheManager</span><span class="pun">(){</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ConcurrentMapCacheManager</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

</span><span class="pun">}</span></code></pre>
<p>Mas ao reiniciar o servidor e tentar acessar a página inicial, teremos um erro. Veja:<img src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/spring-mvc-II-aula1-nome-de-cache-nao-detectado.png" alt="nome de cache não detectado"></p>
<p>O erro indica que nenhum nome de cache foi detectado na aplicação. Isso acontece porque o objeto da classe <code>ConcurrentMapCacheManager</code> usa <code>Map</code> para gerenciar o cache. Os <code>Map</code>s são estruturas de dados que armazenam valores referenciados a partir de chaves. Trata-se de um conjunto de chave e valor.</p>
<p>Para resolver o erro que ocorreu anteriormente, basta passarmos um parâmetro para a anotação <code>@Cacheable</code> indicando qual é a chave do cache daquele método. Usaremos <code>produtosHome</code> como a chave no método <code>index</code> da classe <code>HomeController</code>. Assim teremos:</p>
<pre class="prettyprint"><code><span class="lit">@RequestMapping</span><span class="pun">(</span><span class="str">"/"</span><span class="pun">)</span><span class="pln">
</span><span class="lit">@Cacheable</span><span class="pun">(</span><span class="pln">value</span><span class="pun">=</span><span class="str">"produtosHome"</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">ModelAndView</span><span class="pln"> index</span><span class="pun">(){</span><span class="pln">
    </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">Produto</span><span class="pun">&gt;</span><span class="pln"> produtos </span><span class="pun">=</span><span class="pln"> produtoDao</span><span class="pun">.</span><span class="pln">listar</span><span class="pun">();</span><span class="pln">
    </span><span class="typ">ModelAndView</span><span class="pln"> modelAndView </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ModelAndView</span><span class="pun">(</span><span class="str">"home"</span><span class="pun">);</span><span class="pln">
    modelAndView</span><span class="pun">.</span><span class="pln">addObject</span><span class="pun">(</span><span class="str">"produtos"</span><span class="pun">,</span><span class="pln"> produtos</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> modelAndView</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>Então, refaça o teste que fizemos anteriormente. Reinicie o servidor, limpe o console do <strong>Eclipse</strong> e abra a página inicial da aplicação, você verá uma linha de código <code>SQL</code>. Atualize a página, nada mais aparece no console. Experimente abrir outro navegador, o cache continua funcionando e nenhuma linha a mais de código <code>SQL</code> é impressa. Isto significa que não estamos mais acessando o banco de dados a todo momento. Estamos acessando o cache.</p>
<p>No entanto, o que acontece quando adicionamos um livro novo? Teste adicionar um livro novo e ver o que acontece. Na página de listagem de produtos em <code>localhost:8080/casadocodigo/produtos</code>, o novo livro aparece:<img src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/spring-mvc-II-aula1-lista-de-livros-atualizada.png" alt="novo livro da listagem geral"></p>
<p>Mas a lista da página inicial continua a mesma de antes, ela não será alterada.</p>
<p><img src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/spring-mvc-II-aula1-nova-home.png" alt="lista inicial não atualizada"></p>
<p>A listagem da página inicial agora esta defasada. Ela não é atualizada, quando novos livros são cadastrados no banco de dados. Precisamos fazer com que ao cadastrar um livro novo, o cache seja limpo e que um novo cache seja feito com as atualizações ocorridas no banco de dados. E o método <code>gravar</code> da classe <code>ProdutosController</code> é o local ideal para isso. Mas como o faremos?</p>
<p>Existe uma anotação do <strong>Spring</strong> que nos ajuda com esta tarefa. A anotação <code>@CacheEvict</code> faz exatamente o que queremos. Ela recebe basicamente dois parâmetros, o primeiro se refere a chave do cache que queremos limpar - no caso em que queremos limpar todos os valores. Neste caso os valores desses parâmetros seriam <code>produtosHome</code> e <code>true</code> respectivamente. O método <code>gravar</code> com a nova anotação deverá ficar assim:</p>
<pre class="prettyprint"><code><span class="lit">@RequestMapping</span><span class="pun">(</span><span class="pln">method</span><span class="pun">=</span><span class="typ">RequestMethod</span><span class="pun">.</span><span class="pln">POST</span><span class="pun">)</span><span class="pln">
</span><span class="lit">@CacheEvict</span><span class="pun">(</span><span class="pln">value</span><span class="pun">=</span><span class="str">"produtosHome"</span><span class="pun">,</span><span class="pln"> allEntries</span><span class="pun">=</span><span class="kwd">true</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">ModelAndView</span><span class="pln"> gravar</span><span class="pun">(</span><span class="typ">MultipartFile</span><span class="pln"> sumario</span><span class="pun">,</span><span class="pln"> </span><span class="lit">@Valid</span><span class="pln"> </span><span class="typ">Produto</span><span class="pln"> produto</span><span class="pun">,</span><span class="pln"> </span><span class="typ">BindingResult</span><span class="pln"> result</span><span class="pun">,</span><span class="pln">  </span><span class="typ">RedirectAttributes</span><span class="pln"> redirectAttributes</span><span class="pun">){</span><span class="pln">

</span><span class="pun">[...]</span><span class="pln">

</span><span class="pun">}</span></code></pre>
<p>Com esta última configuração, teremos o seguinte comportamento: O cache será mantido até que um novo livro seja cadastrado, porque a cada novo cadastro, o método <code>gravar</code> será chamado e a anotação do método fará o cache ser limpo. Então, ao acessar a página inicial novamente, um novo cache será feito. Será um ciclo. Teste cadastrar um novo livro e verificar no console o comportamento da aplicação. Agora na página inicial teremos sempre a lista atualizada dos produtos.</p>
<p><img src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/spring-mvc-II-aula1-lista-de-livros-atualizada-ii.png" alt="novo livro adicionado e listado na página de produtos"></p>
<p><img src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/spring-mvc-II-aula1-lista-de-livros-atualizada-ii-editada.png"></p>
<p>Tudo está certo, mas devemos seguir sempre algumas recomendações. A documentação do <strong>Spring</strong>, apesar de fornecer o gerenciador de cache que estamos usando, alerta para que este seja usado apenas em ambiente de desenvolvimento. A sugestão é porque o Spring não permite algumas configurações - como por exemplo, o limite da quantidade de elementos que podem ser guardados no cache ou até mesmo um tempo de vida. Estas configurações são bem interessantes no mundo real e faremos uso delas, com o objetivo de melhorar o gerenciamento de cache pela nossa aplicação.</p>
<p>A documentação recomenda o uso do <strong>Guava</strong>, um <strong><em>framework</em></strong> de cache fornecido pelo <strong>Google</strong>. Para usá-lo, precisaremos alterar algumas de nossas configurações. Primeiro, precisaremos declarar o Guava como uma das dependências do projeto no <code>pom.xml</code></p>
<pre class="prettyprint"><code><span class="tag">&lt;dependency&gt;</span><span class="pln">
    </span><span class="tag">&lt;groupId&gt;</span><span class="pln">com.google.guava</span><span class="tag">&lt;/groupId&gt;</span><span class="pln">
    </span><span class="tag">&lt;artifactId&gt;</span><span class="pln">guava</span><span class="tag">&lt;/artifactId&gt;</span><span class="pln">
    </span><span class="tag">&lt;version&gt;</span><span class="pln">18.0</span><span class="tag">&lt;/version&gt;</span><span class="pln">
</span><span class="tag">&lt;/dependency&gt;</span><span class="pln">

</span><span class="tag">&lt;dependency&gt;</span><span class="pln">
    </span><span class="tag">&lt;groupId&gt;</span><span class="pln">org.springframework</span><span class="tag">&lt;/groupId&gt;</span><span class="pln">
    </span><span class="tag">&lt;artifactId&gt;</span><span class="pln">spring-context-support</span><span class="tag">&lt;/artifactId&gt;</span><span class="pln">
    </span><span class="tag">&lt;version&gt;</span><span class="pln">4.1.0.RELEASE</span><span class="tag">&lt;/version&gt;</span><span class="pln">
</span><span class="tag">&lt;/dependency&gt;</span></code></pre>
<p>Uma das dependências é o próprio Guava. A outra será uma biblioteca que faz a integração do mesmo com o <strong>Spring</strong>. O próximo passo para configurar o Guava em nosso projeto é instanciá-lo com as configurações do cache no mesmo lugar, onde estávamos criando o <code>ConcurrentMapCacheManager</code>, no método <code>cacheManager</code> da classe <code>AppWebConfiguration</code>.</p>
<p>Para podermos adicionar as configurações de tamanho e tempo limite do cache, precisaremos primeiro criar um objeto do tipo <code>CacheBuilder</code> e ao chamar o método <code>newBuilder</code> da classe, podemos chamar logo em seguida os métodos <code>maximumSize</code> e <code>expireAfterAccess</code>, passando valores de <code>100</code> para o tamanho máximo de elementos que serão guardados no cache e <code>5</code> e <code>TimeUnit.MINUTES</code> para o segundo método, respectivamente, indicando que o cache será expirado a cada cinco minutos. O código ficará assim:</p>
<pre class="prettyprint"><code><span class="typ">CacheBuilder</span><span class="pun">&lt;</span><span class="typ">Object</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">&gt;</span><span class="pln"> builder </span><span class="pun">=</span><span class="pln"> </span><span class="typ">CacheBuilder</span><span class="pun">.</span><span class="pln">newBuilder</span><span class="pun">().</span><span class="pln">maximumSize</span><span class="pun">(</span><span class="lit">100</span><span class="pun">).</span><span class="pln">expireAfterAccess</span><span class="pun">(</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="typ">TimeUnit</span><span class="pun">.</span><span class="pln">MINUTES</span><span class="pun">);</span></code></pre>
<p>Após isto, criaremos um objeto do tipo <code>GuavaCacheManager</code> e usar o método <code>setCacheBuilder</code> para passar o <code>builder</code> de cache que criamos anteriormente. Os dois passos feitos agora ficam assim:</p>
<pre class="prettyprint"><code><span class="typ">CacheBuilder</span><span class="pun">&lt;</span><span class="typ">Object</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">&gt;</span><span class="pln"> builder </span><span class="pun">=</span><span class="pln"> </span><span class="typ">CacheBuilder</span><span class="pun">.</span><span class="pln">newBuilder</span><span class="pun">().</span><span class="pln">maximumSize</span><span class="pun">(</span><span class="lit">100</span><span class="pun">).</span><span class="pln">expireAfterAccess</span><span class="pun">(</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="typ">TimeUnit</span><span class="pun">.</span><span class="pln">MINUTES</span><span class="pun">);</span><span class="pln">
</span><span class="typ">GuavaCacheManager</span><span class="pln"> manager </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">GuavaCacheManager</span><span class="pun">();</span><span class="pln">
manager</span><span class="pun">.</span><span class="pln">setCacheBuilder</span><span class="pun">(</span><span class="pln">builder</span><span class="pun">);</span></code></pre>
<p>Por último, retornamos o <code>manager</code> para que seja utilizado pelo Spring para gerenciar o cache da aplicação. O método completo deve estar parecido com este:</p>
<pre class="prettyprint"><code><span class="lit">@Bean</span><span class="pln">
</span><span class="kwd">public</span><span class="pln"> </span><span class="typ">CacheManager</span><span class="pln"> cacheManager</span><span class="pun">(){</span><span class="pln">
  </span><span class="typ">CacheBuilder</span><span class="pun">&lt;</span><span class="typ">Object</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Object</span><span class="pun">&gt;</span><span class="pln"> builder </span><span class="pun">=</span><span class="pln"> </span><span class="typ">CacheBuilder</span><span class="pun">.</span><span class="pln">newBuilder</span><span class="pun">().</span><span class="pln">maximumSize</span><span class="pun">(</span><span class="lit">100</span><span class="pun">).</span><span class="pln">expireAfterAccess</span><span class="pun">(</span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="typ">TimeUnit</span><span class="pun">.</span><span class="pln">MINUTES</span><span class="pun">);</span><span class="pln">
  </span><span class="typ">GuavaCacheManager</span><span class="pln"> manager </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">GuavaCacheManager</span><span class="pun">();</span><span class="pln">
  manager</span><span class="pun">.</span><span class="pln">setCacheBuilder</span><span class="pun">(</span><span class="pln">builder</span><span class="pun">);</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> manager</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre>
<p>Experimente fazer todos os testes novamente. Reinicie o servidor, limpe o console, abra a página inicial e veja se aparece algo no console. Atualize a página, abra a mesma em outro navegador, adicione um novo livro, diminua o tempo de vida do cache para verificar se será gerado um novo depois do tempo limite. Explore outras unidades de tempo da classe <code>TimeUnit</code> para testes.</p>

		</div>
	</div>
</section>
	
	
	
	
	
	
	
	
	
	
	
	

			
				



<section class="task-actions">
	<div class="container">
		





<a href="https://cursos.alura.com.br/forum/curso-springmvc-2-integracao-cache-seguranca-e-templates/exercicio-melhorando-a-home/12225/novo" class=" task-actions-button task-actions-button-forum" data-amplitude-onsubmit="{&quot;name&quot;:&quot;help-needed&quot;,&quot;course-code&quot;:&quot;springmvc-2-integracao-cache-seguranca-e-templates&quot;,&quot;task-id&quot;:&quot;12225&quot;,&quot;task-kind&quot;:&quot;Explicação&quot;}">Tirar Dúvida</a><!--
		 --><a href="https://cursos.alura.com.br/course/springmvc-2-integracao-cache-seguranca-e-templates/task/12225/next" class="task-actions-button task-body-actions-button task-actions-button-next">Próxima Atividade</a>
	</div>
</section>
			
		</main>
	</section>
	











<aside class="task-menu" style="position: fixed; transform: translateY(-272.781px);">
	<section class="task-menu-header">
		<button title="Abrir/Fechar menu" aria-label="Abrir/Fechar menu" type="button" class="openMenu-button task-menu-button "></button>
		<div class="task-menu-header-info">
			<a class="task-menu-header-info-title" href="https://cursos.alura.com.br/course/springmvc-2-integracao-cache-seguranca-e-templates" title="Ir para página do curso">
				<img src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/springmvc-2-integracao-cache-seguranca-e-templates.svg" alt="ícone Spring MVC II: Integração, cache, segurança e templates" class="task-menu-header-info-title-icon " width="37.5px" height="37.5px">
				<h2 class="task-menu-header-info-title-text">Spring MVC II: Integração, cache, segurança e templates</h2>
			</a>
			<div class="task-menu-header-info-progress">
				
				<span class="task-menu-header-info-progress-percentage ">6%</span>
				<span class="task-menu-header-info-progress-bar" style="background-image: linear-gradient(to right, #9de482, #9de482 6%, transparent 6%);"></span>
			</div>
		</div>
	</section>
	
	<section class="task-menu-section">
		<div class="task-menu-section-title">
			<span class="task-menu-section-title-number ">Aula<strong>01</strong>
				<span>de 09</span></span>
			<h3 class="task-menu-section-title-text">
				Melhorando a home 
			</h3>
		</div>
	</section>
	<nav class="task-menu-nav">
		<h2 class="task-menu-nav-title">
			Atividades
			<span>5 de 11</span>
		</h2>
		<ul class="task-menu-nav-list">
			
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/springmvc-2-integracao-cache-seguranca-e-templates/task/12221" class="task-menu-nav-item-link task-menu-nav-item-link-VIDEO">
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Atividade de Vídeo concluída">
						<use xlink:href="/images/gnarus/classPage/icon-menu-icons.svg#VIDEO"></use>
					</svg>
					<span class="task-menu-nav-item-number">01</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Vídeo 1">
							Vídeo 1
						</span>
						
						<span class="task-menu-nav-item-infos">
							
								<span class="task-menu-nav-item-videoDuration" title="Ir para o Vídeo">09min</span>
							
						</span>
					</span>
					
					</a>
				</li>
			
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/springmvc-2-integracao-cache-seguranca-e-templates/task/12222" class="task-menu-nav-item-link task-menu-nav-item-link-VIDEO">
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Atividade de Vídeo concluída">
						<use xlink:href="/images/gnarus/classPage/icon-menu-icons.svg#VIDEO"></use>
					</svg>
					<span class="task-menu-nav-item-number">02</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Vídeo 2">
							Vídeo 2
						</span>
						
						<span class="task-menu-nav-item-infos">
							
								<span class="task-menu-nav-item-videoDuration" title="Ir para o Vídeo">08min</span>
							
						</span>
					</span>
					
					</a>
				</li>
			
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/springmvc-2-integracao-cache-seguranca-e-templates/task/12223" class="task-menu-nav-item-link task-menu-nav-item-link-VIDEO">
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Atividade de Vídeo concluída">
						<use xlink:href="/images/gnarus/classPage/icon-menu-icons.svg#VIDEO"></use>
					</svg>
					<span class="task-menu-nav-item-number">03</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Vídeo 3">
							Vídeo 3
						</span>
						
						<span class="task-menu-nav-item-infos">
							
								<span class="task-menu-nav-item-videoDuration" title="Ir para o Vídeo">07min</span>
							
						</span>
					</span>
					
					</a>
				</li>
			
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/springmvc-2-integracao-cache-seguranca-e-templates/task/12224" class="task-menu-nav-item-link task-menu-nav-item-link-VIDEO">
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Atividade de Vídeo concluída">
						<use xlink:href="/images/gnarus/classPage/icon-menu-icons.svg#VIDEO"></use>
					</svg>
					<span class="task-menu-nav-item-number">04</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Vídeo 4">
							Vídeo 4
						</span>
						
						<span class="task-menu-nav-item-infos">
							
								<span class="task-menu-nav-item-videoDuration" title="Ir para o Vídeo">08min</span>
							
						</span>
					</span>
					
					</a>
				</li>
			
				<li class="task-menu-nav-item task-menu-nav-item--selected">
					<a href="https://cursos.alura.com.br/course/springmvc-2-integracao-cache-seguranca-e-templates/task/12225" class="task-menu-nav-item-link task-menu-nav-item-link-HQ_EXPLANATION">
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Atividade de Explicação concluída">
						<use xlink:href="/images/gnarus/classPage/icon-menu-icons.svg#HQ_EXPLANATION"></use>
					</svg>
					<span class="task-menu-nav-item-number">05</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Melhorando a home ">
							Melhorando a home 
						</span>
						
					</span></a>
				</li>
			
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/springmvc-2-integracao-cache-seguranca-e-templates/task/12226" class="task-menu-nav-item-link task-menu-nav-item-link-TEXT_CONTENT">
					<svg class="task-menu-nav-item-svg " aria-label="Atividade de Atividade sem Resposta do Aluno não concluída">
						<use xlink:href="/images/gnarus/classPage/icon-menu-icons.svg#TEXT_CONTENT"></use>
					</svg>
					<span class="task-menu-nav-item-number">06</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Fazendo o download da Home da Casa do Código">
							Fazendo o download da Home da Casa do Código
						</span>
						
					</span></a>
				</li>
			
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/springmvc-2-integracao-cache-seguranca-e-templates/task/12228" class="task-menu-nav-item-link task-menu-nav-item-link-OPEN_QUESTION">
					<svg class="task-menu-nav-item-svg " aria-label="Atividade de Exercício Aberto não concluída">
						<use xlink:href="/images/gnarus/classPage/icon-menu-icons.svg#OPEN_QUESTION"></use>
					</svg>
					<span class="task-menu-nav-item-number">07</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Alterando o HomeController">
							Alterando o HomeController
						</span>
						
					</span></a>
				</li>
			
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/springmvc-2-integracao-cache-seguranca-e-templates/task/12229" class="task-menu-nav-item-link task-menu-nav-item-link-OPEN_QUESTION">
					<svg class="task-menu-nav-item-svg " aria-label="Atividade de Exercício Aberto não concluída">
						<use xlink:href="/images/gnarus/classPage/icon-menu-icons.svg#OPEN_QUESTION"></use>
					</svg>
					<span class="task-menu-nav-item-number">08</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Habilitando o cache na nossa aplicação">
							Habilitando o cache na nossa aplicação
						</span>
						
					</span></a>
				</li>
			
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/springmvc-2-integracao-cache-seguranca-e-templates/task/12230" class="task-menu-nav-item-link task-menu-nav-item-link-OPEN_QUESTION">
					<svg class="task-menu-nav-item-svg " aria-label="Atividade de Exercício Aberto não concluída">
						<use xlink:href="/images/gnarus/classPage/icon-menu-icons.svg#OPEN_QUESTION"></use>
					</svg>
					<span class="task-menu-nav-item-number">09</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Controlando o cache">
							Controlando o cache
						</span>
						
					</span></a>
				</li>
			
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/springmvc-2-integracao-cache-seguranca-e-templates/task/12231" class="task-menu-nav-item-link task-menu-nav-item-link-TEXT_CONTENT">
					<svg class="task-menu-nav-item-svg task-menu-nav-item-svg--done" aria-label="Atividade de Atividade sem Resposta do Aluno concluída">
						<use xlink:href="/images/gnarus/classPage/icon-menu-icons.svg#TEXT_CONTENT"></use>
					</svg>
					<span class="task-menu-nav-item-number">10</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Adicionando a guava ao nosso projeto">
							Adicionando a guava ao nosso projeto
						</span>
						
					</span></a>
				</li>
			
				<li class="task-menu-nav-item ">
					<a href="https://cursos.alura.com.br/course/springmvc-2-integracao-cache-seguranca-e-templates/task/12232" class="task-menu-nav-item-link task-menu-nav-item-link-OPEN_QUESTION">
					<svg class="task-menu-nav-item-svg " aria-label="Atividade de Exercício Aberto não concluída">
						<use xlink:href="/images/gnarus/classPage/icon-menu-icons.svg#OPEN_QUESTION"></use>
					</svg>
					<span class="task-menu-nav-item-number">11</span>
					<span class="task-menu-nav-item-text">
						<span class="task-menu-nav-item-title" title="Configurando o guava">
							Configurando o guava
						</span>
						
					</span></a>
				</li>
			
		</ul>
	</nav>
	<section class="task-menu-sections">
		<h2 class="task-menu-sections-title">
			Aulas
		</h2>
		<select class="task-menu-sections-select" onchange="location.href=&#39;/course/springmvc-2-integracao-cache-seguranca-e-templates/section/&#39;+this.value;">
			
				<option value="1" selected="">01. Melhorando a home </option>
			
				<option value="2">02. Retornando no formato JSON</option>
			
				<option value="3">03. Usando o Bootstrap</option>
			
				<option value="4">04. Personalizando o login e logout</option>
			
				<option value="5">05. Trabalhando com Templates</option>
			
				<option value="6">06. Mudando o locale dinamicamente</option>
			
				<option value="7">07. Testando a aplicação</option>
			
				<option value="8">08. Realizando Ajustes Finais no Projeto</option>
			
				<option value="9">09. Publicando o projeto</option>
			
		</select>
	</section>
	<section class="task-menu-others">
		<h2 class="task-menu-others-title ">
			Outros Links
		</h2>
		<a href="https://cursos.alura.com.br/forum/curso-springmvc-2-integracao-cache-seguranca-e-templates/todos" class="task-menu-others-link task-menu-others-link-forum " title="Ir para o fórum do curso">Fórum</a>
		<a href="https://cursos.alura.com.br/dashboard" class="task-menu-others-link task-menu-others-link-curso" title="Ir para a página principal">Trocar Curso</a>
	</section>
	<section class="task-menu-footer">
		<a class="task-menu-footer-user" href="https://cursos.alura.com.br/user/altair-lage" title="Ir para sua página de usuário">
			<img src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/846d7bad034e3c292bc8e433e11b4683.png" alt="Gravatar de Altair Lage" class="task-menu-footer-img" width="40px" height="40px">
			
				<p class="task-menu-footer-detalhes">
					<span class="task-menu-footer-detalhes-nome">Altair Lage</span>
					<span class="task-menu-footer-detalhes-xp">
						40.0k xp
					</span>
				</p>
			
			<input type="hidden" value="">
			<input type="hidden" value="">
		</a>
		<a href="https://cursos.alura.com.br/dashboard" class="task-menu-footer-logo">
			<img src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/icon-menu-alura.svg" alt="Logo da Alura" class="task-menu-footer-logo-image" width="19px" height="32px" title="Ir para a página principal">
		</a>
	</section>
</aside>
</section>




	<script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/jquery-2.1.3.min.32015dd4.js.download"></script>
	<script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/buttonToggle.83185c05.js.download" async=""></script>
	<script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/sectionMenu.ba849510.js.download" async=""></script>

	<script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/marked.98ce0051.js.download"></script>
	<script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/markdownEditor.f940de44.js.download" async=""></script>
	<script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/caret.637d95c2.js.download" async=""></script>
	<script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/keydownWatchers.67f33811.js.download" async=""></script>
	<script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/prettify.4992e3fe.js.download" async=""></script>

	<script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/preventsDoubleClick.0a7a943f.js.download" async=""></script>
	<script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/assessment.050f656f.js.download" async=""></script>
	<script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/login-form.1730703f.js.download" async=""></script>
	<script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/classPage.85152a83.js.download"></script>
	<script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/aria.a0feb01e.js.download"></script>
	<script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/phrase.80dcd2b8.js.download"></script>
	<script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/feedback.2d335882.js.download"></script>
	
	

	
	
	
	

	<script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/partitura.977fb5b2.js.download"></script>
	<script src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/audioProgress.6f445a1c.js.download"></script>

	
	
	
		

<script type="text/javascript" src="./Spring MVC II_ Aula 1 - Atividade 5 Melhorando a home _ Alura - Cursos online de tecnologia_files/amplitude.f1f6e4b7.js.download"></script>

<script>

	amplitudeInit("84647047775d06b4051d80eccd387bd3");
	
	
		var userProperties = {"name":"Altair Lage","email":"altair.lage@datablink.com"};
		amplitudeIdentify("75042", userProperties);
	
	
	

	
	
	$('[data-amplitude]').on('click', function(){
		var data = $(this).data().amplitude;
		track(data);
	});
	
</script>

		
		
			<script>
				track({"name":"task-seen","course-code":"springmvc-2-integracao-cache-seguranca-e-templates","task-id":"12225","task-kind":"Explicação"});
			</script>
		
	
	
 

<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"errorBeacon":"bam.nr-data.net","licenseKey":"b5f9030682","agent":"","beacon":"bam.nr-data.net","applicationTime":47,"applicationID":"12544460","transactionName":"ZVFTNhEEXEdTWkdeV1wbchcQEV1ZHVtBGVtdWR8BAgBeQV8XVFlZQEFCTAsEQFhXQEJCUVxaHwEMC0ZGXVVfUkocZ1QBFwxdWnFWXUNKXVhdBxFKQVxdTmdWS1k=","queueTime":0}</script>

</body><span class="gr__tooltip"><span class="gr__tooltip-content"></span><i class="gr__tooltip-logo"></i><span class="gr__triangle"></span></span></html>